var map;$(document).ready(function(){function a(a,o){var e=JSON.stringify(a);$(".result__wrapper").append('<div class="result"><p class="result__title">'+a.carparkName[0].name+'</p><p class="result__address">'+a.waypoints[0].location+'</p><p class="result__more"><a href="#result-'+a.waypoints[0].location+'" class="result__more-link js-overlay-open js-overlay-open-dialog">More carpark information</a></p><div id="result-'+a.waypoints[0].location+'" class="overlay overlay--dialog mfp-hide"><div class="overlay__content"><p>You could save Â£201.40 in a year in fuel alone</p><p>You could save 103Kg of CO2 in a year</p><p>You could save 103,203 calories in a year</p><p>(or 52 Mars Bars)</p><p>You could save 98,030 calories in a year</p><p>(or 50 Mars Bars)</p></div></div><p class="result__address"><img src="/ui/images/car.png"> '+o[0].distance.text+'</p><p class="result__address"><img src="/ui/images/bike.png"> '+o[1].distance.text+'</p><p class="result__choose"><a href="#" data-route="'+e+'" class="magic-happen choose-result btn--secondary btn">Show this route</a></p>')}function o(a){map.drawRoute({origin:a.origin,destination:a.destination,waypoints:[{location:a.waypoints[0].location}],travelMode:"bicycling",strokeColor:"#131540",strokeOpacity:.3,strokeWeight:3})}map=new GMaps({div:"#mapHolder",zoom:12,lat:51.45,lng:-2.5833}),$(".result__wrapper").on("click",".magic-happen",function(){console.log("hola"),console.log($(this).data("route")),o(JSON.parse($(this).data("route")))}),$("#submit-options").click(function(){$(".wr__nav").hide(),$(".wr__results").show(),$(".home-copy").fadeOut();var o="bs57xt",e="bs14nd",s=function(){var a=null;return $.ajax({async:!1,global:!1,url:"/parking.json",dataType:"json",success:function(o){a=o}}),a}();GMaps.geocode({address:o,callback:function(o,i){if("OK"==i){var t=o[0].geometry.location;GMaps.geocode({address:e,callback:function(o,e){if("OK"==e){var i=o[0].geometry.location,n={origin:[t.k,t.A],destination:[i.k,i.A],travelMode:"bicycling",waypoints:[{location:s.car_parks[0].postcode}],carparkName:[{name:s.car_parks[0].name}]};map.getRoutes({origin:[t.k,t.A],destination:[i.k,i.A],travelMode:"bicycling",waypoints:[{location:s.car_parks[0].postcode}],callback:function(o){a(n,o[0].legs)}})}}})}}}),GMaps.geocode({address:o,callback:function(o,i){if("OK"==i){var t=o[0].geometry.location;GMaps.geocode({address:e,callback:function(o,e){if("OK"==e){var i=o[0].geometry.location,n={origin:[t.k,t.A],destination:[i.k,i.A],travelMode:"bicycling",waypoints:[{location:s.car_parks[1].postcode}],carparkName:[{name:s.car_parks[1].name}]};map.getRoutes({origin:[t.k,t.A],destination:[i.k,i.A],travelMode:"bicycling",waypoints:[{location:s.car_parks[1].postcode}],callback:function(o){a(n,o[1].legs)}})}}})}}}),GMaps.geocode({address:o,callback:function(o,i){if("OK"==i){var t=o[0].geometry.location;GMaps.geocode({address:e,callback:function(o,e){if("OK"==e){var i=o[0].geometry.location,n={origin:[t.k,t.A],destination:[i.k,i.A],travelMode:"bicycling",waypoints:[{location:s.car_parks[2].postcode}],carparkName:[{name:s.car_parks[2].name}]};map.getRoutes({origin:[t.k,t.A],destination:[i.k,i.A],travelMode:"bicycling",waypoints:[{location:s.car_parks[2].postcode}],callback:function(o){a(n,o[2].legs)}})}}})}}})}),$(".quick-nav a").on("click",function(){$(".home-copy").hide(),$(document.getElementById($(this).data("id"))).show()}),$(".wr__results").on("click",".js-overlay-open",function(a){a.preventDefault(),$($(this).attr("href")).removeClass("mfp-hide")})});